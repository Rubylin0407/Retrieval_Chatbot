<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>旅行團行程小幫手</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.5/flowbite.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.5/flowbite.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        .container {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .box {
            width: min(95%, 800px);
            height: 100vh;
            margin-top: 85px;
        }

        .bottom {
            position: fixed;
            bottom: 0;
            padding-bottom: 5%;
            background-color: white;
            width: min(95%, 800px);
        }

        .message {
            margin: 20px;
        }

        .usermessagediv {
            display: flex;
            justify-content: flex-end;
            flex-wrap: wrap;
            margin-left: 20%;
        }

        .usermessage {
            background-color: #097df1;
            color: #fff;
            padding: 0.5rem .875rem;
            border-radius: 20px;
        }

        .appmessagediv {
            display: flex;
            justify-content: flex-start;
            flex-wrap: wrap;
            margin-right: 20%;
            white-space: pre-line;
        }

        .appmessage {
            background-color: #e5e5ea;
            color: #000;
            padding: 0.5rem .875rem;
            border-radius: 20px;
        }

        .upper {
            max-height: 100%;
            padding-top: 40px;
            padding-bottom: 170px;
            overflow: auto;
        }

        .upper::-webkit-scrollbar {
            width: 0 !important
        }

        #sendbtn:disabled {
            opacity: 0.6;
        }

        .downwarning {
            display: flex;
            justify-content: center;
            margin-top: 5px;
            font-size: 90%;
            color: gray;
        }

        nav {
            position: fixed;
            width: 100%;
            padding: 3px;
            box-shadow: 1px 1px 5px #80808057;
            z-index: 2;
        }
    </style>
</head>

<body>

    <nav class="bg-white border-gray-200 dark:bg-gray-900">
        <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
            <a href="#" class="flex items-center">
                <span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">旅行團行程小幫手</span>
            </a>
            
            <div class="flex space-x-4">
                {% if session['logged_in'] %}
                    <!-- Display username when logged in -->
                    <span class="text-gray-600">Hello, {{ session['username'] }}!</span>
                    <a href="/user/logout" class="text-gray-600 hover:text-gray-800">Log out</a>
                {% else %}
                    <!-- Display login and signup links when not logged in -->
                    <a href="/user/login" class="text-gray-600 hover:text-gray-800">Log in</a>
                    <a href="/user/signup" class="text-gray-600 hover:text-gray-800">Sign up</a>
                {% endif %}
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="box">
            <!-- Placeholder for Bar Chart -->
            <div id="bar-chart"></div>
    
            <!-- Placeholder for Bubble Plot -->
            <div id="bubble-plot"></div>
    
            <!-- Search History Section (Add your code for displaying search history here) -->
            <div id="search-history"></div>
            <!-- Display search history here -->          

            <div id="chatbot-container"></div>

        </div>
    </div>


    <!-- Add JavaScript code for Plotly charts -->
    <script>
        // Create a sample bar chart
        var barData = [
            {
                x: ['Category A', 'Category B', 'Category C'],
                y: [10, 20, 15],
                type: 'bar'
            }
        ];
        Plotly.newPlot('bar-chart', barData);
    
        // Create a sample bubble plot
        var bubbleData = [
            {
                x: [1, 2, 3],
                y: [10, 11, 12],
                mode: 'markers',
                marker: {
                    size: [30, 80, 50]
                }
            }
        ];
        Plotly.newPlot('bubble-plot', bubbleData);
    
        // Add code for displaying search history (you'll need to update this)
        function displaySearchHistory(history) {
            // Display search history items here
        }
        
        document.addEventListener('DOMContentLoaded', function () {
        // Function to create and embed the chatbot iframe
        function embedChatbot() {
            const chatbotContainer = document.getElementById('chatbot-container');
            const iframe = document.createElement('iframe');
            iframe.src = '/chatbot'; // URL of the chatbot.html page
            iframe.frameBorder = 0;
            iframe.width = '100%';
            iframe.height = '600px'; // Set the desired height
            chatbotContainer.appendChild(iframe);
        }

        // Call the function to embed the chatbot when the page loads
        embedChatbot();
    });
    </script>
</body>